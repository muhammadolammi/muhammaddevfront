# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Deploy to Firebase Hosting on push and merge
on:
  push :
   branches: 
     main


permissions:
 checks: write
 contents: read
 pull-requests: write
jobs:
 build_and_preview:
  
   runs-on: ubuntu-latest
   env:
     REACT_APP_API_URL: ${{secrets.REACT_APP_API_URL}}
     REACT_APP_API_KEY: ${{secrets.REACT_APP_API_KEY}}
   steps:
     - uses: actions/checkout@v4
     - name: Cache npm dependencies
       uses: actions/setup-node@v4
       with:
         node-version: 20
         cache: 'npm'
     
     - name: Install npm depencies and Build the app
       run: CI=false npm ci && CI=false npm run build
     - name: Run tests
       run: npm test 
     - uses: FirebaseExtended/action-hosting-deploy@v0
       with:
         repoToken: ${{ secrets.GITHUB_TOKEN }}
         firebaseServiceAccount: ${{ secrets.FIREBASE_SERVICE_ACCOUNT_MUHAMMADDEV_38975 }}
         projectId: muhammaddev-38975
